<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>招式影片展示</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin:0; 
      display:flex; 
      height:100vh; 
      overflow:hidden; /* 避免整頁出現多重捲軸 */
    }
    /* 左側招式選單 */
    #menuPanel {
      width:320px; 
      background:#f4f4f4; 
      padding:15px; 
      overflow-y:auto;   /* ✅ 垂直捲動 */
      border-right: 2px solid #ccc;
    }
    .category, .moveGroup { margin-left:10px; margin-bottom:10px; }
    .toggle { cursor:pointer; font-weight:bold; margin:8px 0; }
    button.videoBtn { 
      display:block; 
      margin:6px 0; 
      width:100%; 
      text-align:left; 
      font-size:16px; 
      padding:12px; 
      cursor:pointer; 
    }
    /* 主區域 */
    #main { 
      flex:1; 
      display:flex; 
      flex-direction:column; 
      align-items:center; 
      justify-content:space-between; 
      overflow:hidden;
    }
    #playerContainer { 
      flex:1; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      position:relative; 
      width:100%;
    }
    #player { 
      width:100%; 
      max-width:1280px; /* 不讓太寬 */
      height:70vh;      /* 佔視窗高度 70% */
      border:none; 
    }
    /* 速度控制 */
    #speedControls {
      position:absolute; 
      right:10px; 
      top:10px; 
      display:flex; 
      flex-direction:column; 
      gap:10px;
    }
    #speedControls button { 
      padding:8px 12px; 
      font-size:15px; 
      cursor:pointer;
    }
    /* 底部影片快速切換列 */
    #bottomBar {
      background:#eee; 
      padding:14px; 
      display:flex; 
      justify-content:center; 
      gap:14px;
      border-top:2px solid #ccc;
      width:100%;
      overflow-x:auto; /* ✅ 水平捲動，避免影片多時擠不下 */
    }
    #bottomBar button {
      padding:12px 18px;
      font-size:16px;
      cursor:pointer;
      flex-shrink:0; /* 保證按鈕大小固定，不會被壓縮 */
    }
  </style>
</head>
<body>

  <!-- 左側招式選單 -->
  <div id="menuPanel"></div>

  <!-- 主區域 -->
  <div id="main">
    <div id="playerContainer">
      <div id="player"></div>
      <div id="speedControls"></div>
    </div>
    <div id="bottomBar"></div>
  </div>

  <script>
    // ================== 資料 ==================
    const categories = [
      {
        name: "一. 主動技",
        sub: [
          {
            name: "2. 二段技",
            sub: [
              {
                name: "a. 小手面",
                videos: [
                  { name: "1", videoId: "9S5s9KnxrHE", start: 918 },
                  { name: "2", videoId: "JuI_ZaTYwlk", start: 56 }
                ]
              },
              {
                name: "b. 面面",
                videos: [
                  { name: "1", videoId: "RAQBc9B-eQA", start: 280 }
                ]
              },
              {
                name: "c. 突き面",
                videos: [
                  { name: "1", videoId: "49znwod-mCo", start: 148 },
                  { name: "2", videoId: "mksT0tIlXYc", start: 180 }
                ]
              }
            ]
          },
          {
            name: "3. 撥劍技",
            sub: [
              {
                name: "a. 裏側撥劍面",
                videos: [
                  { name: "1", videoId: "U-_KZyDRfck", start: 231 },
                  { name: "0", videoId: "0", start: 0 }
                ]
              }
            ]
          },
          {
            name: "1. 騙技",
            sub: [
              {
                name: "a. 騙面打小手",
                videos: [
                  { name: "1", videoId: "0", start: 0 },
                  { name: "0", videoId: "0", start: 0 }
                ]
              }
            ]
          },
          {
            name: "1. 其他",
            sub: [
              {
                name: "a. 大角度小手",
                videos: [
                  { name: "1", videoId: "U-_KZyDRfck", start: 314 },
                  { name: "0", videoId: "0", start: 0 }
                ]
              },
              {
                name: "b. 下攻め突き",
                videos: [
                  { name: "1", videoId: "U-_KZyDRfck", start: 367 },
                  { name: "0", videoId: "", start: 0 }
                ]
              },
              {
                name: "c. 突き返し面",
                videos: [
                  { name: "1", videoId: "6cgyfhEo5ks", start: 494 },
                  { name: "2", videoId: "mksT0tIlXYc", start: 41 }
                ]
              }
            ]
          }
        ]
      },
      {
        name: "二. 反擊技",
        sub: [
          {
            name: "1. 返し技",
            sub: [
              {
                name: "a. 返し面",
                videos: [
                  { name: "0", videoId: "", start: 0 },
                  { name: "0", videoId: "", start: 0 }
                ]
              },
              {
                name: "b. 返し胴",
                videos: [
                  { name: "0", videoId: "", start: 0 },
                  { name: "0", videoId: "", start: 0 }
                ]
              },
              {
                name: "c. 返し小手",
                videos: [
                  { name: "0", videoId: "", start: 0 }
                ]
              }
            ]
          }
        ]
      },
      {
        name: "三. 退擊技",
        sub: [
          {
            name: "1. 引き技",
            sub: [
              {
                name: "a. 引き面",
                videos: [
                  { name: "0", videoId: "", start: 0 },
                  { name: "0", videoId: "", start: 0 }
                ]
              },
              {
                name: "b. 引き胴",
                videos: [
                  { name: "0", videoId: "", start: 0 },
                  { name: "0", videoId: "", start: 0 }
                ]
              },
              {
                name: "c. 引き小手",
                videos: [
                  { name: "0", videoId: "", start: 0 }
                ]
              },
              {
                name: "d. 其他",
                videos: [
                  { name: "騙退胴退面", videoId: "U-_KZyDRfck", start: 347 }
                ]
              }
            ]
          }
        ]
      }
    ];


    let currentVideos = []; // 目前選中的影片群組
    let player; // YouTube 播放器實例

    // ================== YouTube API 初始化 ==================
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '390',
        width: '640',
        videoId: '',
        playerVars: { autoplay: 0 },
      });
    }
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.body.appendChild(tag);

    // ================== 建立選單 ==================
    const menuPanel = document.getElementById("menuPanel");
    const bottomBar = document.getElementById("bottomBar");
    const speedControls = document.getElementById("speedControls");

    function buildMenu(data, parent) {
      data.forEach(item => {
        if (item.sub) {
          const div = document.createElement("div");
          div.className = "category";
          const title = document.createElement("div");
          title.className = "toggle";
          title.textContent = item.name;
          div.appendChild(title);

          const subDiv = document.createElement("div");
          subDiv.style.display = "block"; // 預設打開
          buildMenu(item.sub, subDiv);
          div.appendChild(subDiv);

          parent.appendChild(div);
        } else if (item.videos) {
          const group = document.createElement("div");
          group.className = "moveGroup";
          const title = document.createElement("div");
          title.className = "toggle";
          title.textContent = item.name;
          group.appendChild(title);

          const videoDiv = document.createElement("div");
          videoDiv.style.display = "block";
          item.videos.forEach((v, idx) => {
            const btn = document.createElement("button");
            btn.className = "videoBtn";
            btn.textContent = v.name;
            btn.onclick = () => playVideoGroup(item.videos, idx);
            videoDiv.appendChild(btn);
          });
          group.appendChild(videoDiv);
          parent.appendChild(group);
        }
      });
    }

    buildMenu(categories, menuPanel);

    // ================== 播放與底部快捷 ==================
    function playVideoGroup(videos, startIdx) {
      currentVideos = videos;
      renderBottomBar();
      loadVideo(startIdx);
    }

    function renderBottomBar() {
      bottomBar.innerHTML = "";
      currentVideos.forEach((v, idx) => {
        const btn = document.createElement("button");
        btn.textContent = v.name;
        btn.onclick = () => loadVideo(idx);
        bottomBar.appendChild(btn);
      });
    }

    function loadVideo(idx) {
      const v = currentVideos[idx];
      if (player && player.loadVideoById) {
        player.loadVideoById({ videoId: v.videoId, startSeconds: v.start });
      }
    }

    // ================== 播放速度控制 ==================
    const speeds = [0.25, 0.5, 1];
    speeds.forEach(s => {
      const btn = document.createElement("button");
      btn.textContent = s + "x";
      btn.onclick = () => { if (player) player.setPlaybackRate(s); };
      speedControls.appendChild(btn);
    });
  </script>

</body>
</html>
